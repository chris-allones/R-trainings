<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Training Workshop on Data Visualization using ggplot2 in R</title>
    <meta charset="utf-8" />
    <script src="02_understanding_ggplot2_files/header-attrs/header-attrs.js"></script>
    <script src="02_understanding_ggplot2_files/clipboard/clipboard.min.js"></script>
    <link href="02_understanding_ggplot2_files/shareon/shareon.min.css" rel="stylesheet" />
    <script src="02_understanding_ggplot2_files/shareon/shareon.min.js"></script>
    <link href="02_understanding_ggplot2_files/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="02_understanding_ggplot2_files/xaringanExtra-shareagain/shareagain.js"></script>
    <meta name="github-repo" content="chris-allones/training-data-viz"/>
    <meta name="twitter:title" content="Data viz with ggplot2"/>
    <meta name="twitter:description" content="Training Workshop on Data Visualization using ggplot2 in R."/>
    <meta name="twitter:url" content="https://chris-allones.github.io/data-viz-ggplot2/index.html"/>
    <meta name="twitter:image" content="https://chris-allones.github.io/data-viz-ggplot2/images/preview.png"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:creator" content="@Topenomics"/>
    <meta name="twitter:site" content="@Topenomics"/>
    <meta property="og:title" content="Data viz with ggplot2"/>
    <meta property="og:description" content="Training Workshop on Data Visualization using ggplot2 in R."/>
    <meta property="og:url" content="https://chris-allones.github.io/data-viz-ggplot2/index.html"/>
    <meta property="og:image" content="https://chris-allones.github.io/data-viz-ggplot2/images/preview.png"/>
    <meta property="og:type" content="website"/>
    <meta property="og:locale" content="en_US"/>
    <meta property="article:author" content="Christopher Llones"/>
    <link href="02_understanding_ggplot2_files/tile-view/tile-view.css" rel="stylesheet" />
    <script src="02_understanding_ggplot2_files/tile-view/tile-view.js"></script>
    <link href="02_understanding_ggplot2_files/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <link href="02_understanding_ggplot2_files/animate.css/animate.xaringan.css" rel="stylesheet" />
    <link href="02_understanding_ggplot2_files/animate.css-xaringan/animate.fade.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="css/presentation.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Training Workshop on Data Visualization using ggplot2 in R
## Session 2: Understanding grammar of graphics

---


layout: true

<style>.shareagain-bar {
--shareagain-foreground: rgb(255, 255, 255);
--shareagain-background: rgba(0, 0, 0, 0.5);
--shareagain-pinterest: none;
--shareagain-pocket: none;
--shareagain-reddit: none;
}</style>





---

## Outline

+ The grammar of graphics

+ Datasets and mapping

+ Geometries

+ Statistical transformation and plotting distribution

+ Position adjustment and scales

+ Coordinates and themes

+ Facets and custom plots

---

class: middle center

# The grammar of graphics
----


---

## Why ggplot2?

.leftcol[

+ Most requested programming languages for data scientists are R and Python.

+ ggplot2 as a visualization package for R, is becoming an industry standard for visualization.

]


.rightcol[
&lt;img src="image/ggplot2_logo.png" width="40%" style="display: block; margin: auto;" /&gt;
]


---

## Why ggplot2?

.leftcol[

+ Relies on an underlying grammar, called layered grammar of graphics

+ Grammars on statistical graphics:

  + Bertin, 1983
  
  + Wilkinson, 2005
  
  + Wickham, 2010

]


.rightcol[
&lt;img src="image/gg_book_cover.jfif" width="40%" style="display: block; margin: auto;" /&gt;

.center[Source: [The grammar of graphics](https://link.springer.com/book/10.1007/0-387-28695-0)]
]


---

## Why a grammar?

.leftcol[

+ You can create new sentences if you know about the grammar.

+ In ggplot2 context, you can create new graphics or tailored plot that suits your needs or preferences.

]


.rightcol[
&lt;img src="image/gg_book_cover.jfif" width="40%" style="display: block; margin: auto;" /&gt;

.center[Source: [The grammar of graphics](https://link.springer.com/book/10.1007/0-387-28695-0)]
]


---

## The idea of grammar of graphics

.left[
&lt;br&gt;
&lt;img src="image/gg0.png" width="50%" style="display: block; margin: auto;" /&gt;

]


---

## The idea of grammar of graphics

.leftcol[


&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.rightcol[
&lt;img src="image/gg_data.png" width="50%" style="display: block; margin: auto;" /&gt;


```r
ggplot(data = data1)
```
]

---

## The idea of grammar of graphics

.leftcol[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.rightcol[
&lt;img src="image/gg_map.png" width="50%" style="display: block; margin: auto;" /&gt;


```r
ggplot(data = data1, 
*      mapping = aes(x = price, y = carat, color = clarity))
```
]


---

## The idea of grammar of graphics



.leftcol[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.rightcol[
&lt;img src="image/gg_geom.png" width="50%" style="display: block; margin: auto;" /&gt;


```r
ggplot(data = data1, 
       mapping = aes(x = price, y = carat, color = clarity)) +
* geom_point()
```
]


---

## The idea of grammar of graphics

.leftcol[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.rightcol[
&lt;img src="image/gg_stat.png" width="50%" style="display: block; margin: auto;" /&gt;


```r
ggplot(data = data1, 
       mapping = aes(x = price, y = carat, color = clarity)) +
  geom_point() +
* stat_smooth()
```
]


---

## The idea of grammar of graphics

.leftcol[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.rightcol[
&lt;img src="image/gg_scale.png" width="50%" style="display: block; margin: auto;" /&gt;


```r
ggplot(data = data1, 
       mapping = aes(x = price, y = carat, color = clarity)) +
  geom_point() +
  stat_smooth() +
* scale_x_log10()
```
]


---

## The idea of grammar of graphics

.leftcol[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-21-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.rightcol[
&lt;img src="image/gg_coord.png" width="50%" style="display: block; margin: auto;" /&gt;


```r
ggplot(data = data1, 
       mapping = aes(x = price, y = carat, color = clarity)) +
  geom_point() +
  stat_smooth() +
  scale_x_log10() +
* coord_flip()
```
]




---

## The idea of grammar of graphics

.leftcol[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


.rightcol[
&lt;img src="image/gg_facet.png" width="50%" style="display: block; margin: auto;" /&gt;


```r
ggplot(data = data1, 
       mapping = aes(x = price, y = carat, color = clarity)) +
  geom_point() +
  stat_smooth() +
  scale_x_log10() +
  coord_flip() +
* facet_wrap(~ cut)
```
]


---

## The idea of grammar of graphics

.leftcol[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.rightcol[
&lt;img src="image/gg_theme.png" width="50%" style="display: block; margin: auto;" /&gt;


```r
ggplot(data = data1, 
       mapping = aes(x = price, y = carat, color = clarity)) +
  geom_point() +
  stat_smooth() +
  scale_x_log10() +
  coord_flip() +
  facet_wrap(~ cut) +
* theme_light()
```
]


---

class: middle center

# Data and mapping
----

---

## Data

.leftcol60[
+ syntax

```r
ggplot(data = &lt;dataset&gt;)
```

+ For ggplot graphs, data are usually wrangled.

+ Tidy data

  + Each variable is a column
  
  + Each observation is a row
  
  + Each value is a cell
]

.rightcol40[
&lt;img src="image/gg_data.png" width="70%" style="display: block; margin: auto;" /&gt;
]


---

## Mappings

.leftcol60[
+ syntax

```r
ggplot(data = &lt;dataset&gt;,
*      mapping = aes(x = &lt;var1&gt;, y = &lt;var2&gt;, ...))
```

+ Variables are mapped to graphic's visual properties with **aesthetics mapping**

+ Usually we map:

  + one variable on x axis
  
  + one variable on y axis
  
  + mapped to color, shape, fill, group, etc.
]

.rightcol40[
&lt;img src="image/gg_map.png" width="70%" style="display: block; margin: auto;" /&gt;
]

---

## Data and mappings

.leftcol60[

+ Can specify data and mappings in the plot category


```r
ggplot(data = mydata, mapping = aes(x = varX, y = varY))
```

+ Or specify for each layer


```r
ggplot() +
  geom_point(data = mydata, mapping = aes(x = varX, y =varY))
```
]

.rightcol40[
&lt;img src="image/gg_data_map.png" width="70%" style="display: block; margin: auto;" /&gt;
]


---

## Data and mapping

.leftcol[

```r
ggplot(data = mpg, 
*      mapping = aes(x = displ, y = hwy, color = class)) +
  geom_point() +
  geom_smooth(se = FALSE)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-38-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

.rightcol[

```r
ggplot(data = mpg, 
       mapping = aes(x = displ, y = hwy)) +
* geom_point(aes(color = class)) +
  geom_smooth(se = FALSE)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-40-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Aesthetic mapping

.leftcol[

**Setting vs mapping**

Important difference

+ **map** an aesthetic to a **variable**
  
+ **set** an aesthetic to a **constant** value

]

.rightcol[
&lt;img src="image/aesthetics_list.jpg" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Aesthetic mapping

.leftcol[
**mapping**

```r
ggplot(data = mpg, 
*      mapping = aes(x = displ, y = hwy, color = class)) +
  geom_point()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-43-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.rightcol[
**setting**

```r
ggplot(data = mpg, 
       mapping = aes(x = displ, y = hwy, color = class)) +
* geom_point(color  = "red")
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-45-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]



---

class: middle center

# Geometries
----

---

## Geometries

.leftcol60[
+ syntax

```r
ggplot(data = &lt;dataset&gt;,
       mapping = aes(x = &lt;varX&gt;, y = &lt;varY&gt;, ...)) +
* geom_&lt;function&gt;(...)
```

+ Geometry stands for geom function

+ Tell R how to render each data point on a given figure.

]

.rightcol40[
&lt;img src="image/gg_geom.png" width="70%" style="display: block; margin: auto;" /&gt;
]


---

## Geometries

.center[
&lt;img src="image/geom_collection.png" width="70%" style="display: block; margin: auto;" /&gt;
.fifty[
Source: [National Bioinformatics Insfrastructure Sweden (NBIS), 2019](https://github.com/NBISweden/RaukR-2019/blob/master/docs/ggplot/presentation/ggplot_presentation_assets/geoms.png) ]
]


---

## Geometries

.leftcol40[
+ Each geom can display certain aesthetics.

+ Some of them are required.

]

.rightcol60[
&lt;img src="image/geom_aes_summary.jpg" width="90%" style="display: block; margin: auto;" /&gt;
]


---

## Geometries

.leftcol40[

**Line plots**

Aesthetics of `geom_path`, `geom_line`, `geom_step`:

+ x
+ y
+ alpha
+ colour/ color
+ linetype
+ size
+ group

We will use the `babynames` data from the `babynames` package for demonstration.

]

.rightcol60[

```r
install.packages("babynames")
library(babynames)
glimpse(babynames)
```


```
Rows: 1,924,665
Columns: 5
$ year &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880,~
$ sex  &lt;chr&gt; "F", "F", "F", "F", "F", "F", "F", "F", "F", "F", "F", "F", "F", ~
$ name &lt;chr&gt; "Mary", "Anna", "Emma", "Elizabeth", "Minnie", "Margaret", "Ida",~
$ n    &lt;int&gt; 7065, 2604, 2003, 1939, 1746, 1578, 1472, 1414, 1320, 1288, 1258,~
$ prop &lt;dbl&gt; 0.07238359, 0.02667896, 0.02052149, 0.01986579, 0.01788843, 0.016~
```
]


---

## Geometries

.leftcol40[

**Line plots: practice exercise**

+ Recreate the plot shown on the right.

]

.rightcol60[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-52-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Geometries

.leftcol60[
**Scatterplots**

We can derived plots like:

+ Connected scatter plot (if `geom_line` is added)
+ Bubble plot (mapping size to a variable)

To avoid overlappping
+ alpha aesthetic
+ "jitter" or `geom_jitter` for position

]

.rightcol40[

```r
geom_point(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)
```
]


---

## Geometries

.leftcol60[
**Scatterplots**

#### Colors

+ continuous data
  + `scale_color_gradient`
  + `scale_fill_gradient`
  
+ discrete data
  + `scale_color_manual`
  + `scale_fill_manual`
]

.rightcol40[

```r
geom_point(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)
```
]


---

## Geometries

.leftcol40[

**Scatter plot: practice exercise**

Use the `mpg` data to recreate the plot shown on the right.

]

.rightcol60[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-55-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

class: middle center

# Statistical transformation and plotting distribution
----

---

## Statistics

.leftcol60[
+ syntax

```r
ggplot(data = &lt;dataset&gt;,
       mapping = aes(x = &lt;varX&gt;, y = &lt;varY&gt;, ...)) +
* geom_&lt;function&gt;(..., stat = &lt;stat&gt;, position = &lt;position&gt;) +
* geom_&lt;stat&gt;(...)
```

+ Every layer has a statistical transformation associated to it.

+ **geoms** control the way the plot looks

+ **stats** control the way the data is transformed

]

.rightcol40[
&lt;img src="image/gg_stat.png" width="70%" style="display: block; margin: auto;" /&gt;
]

---

## Statistics

**Geoms and stats**
.leftcol[
Every geometry has a default stat.
+ `geom_line` default stat is `stat_identity`
+ `geom_point` default stat is `stat_identity`
+ `geom_smooth` default stat is `stat_smooth`

Each stat has a default geom
+ `stat_smooth` default geom is `geom_smooth`
+ `stat_count` default geom is `geom_bar`
+ `stat_sum` default geom is `geom_point`
]

.rightcol40[
&lt;img src="image/gg_stat.png" width="70%" style="display: block; margin: auto;" /&gt;
]

---

## Statistics

.leftcol[
**Interesting stats**
+ `stat_smooth(geom_smooth)`
+ `stat_unique(geom_point)`
+ `stat_summary(geom_pointrange`
+ `stat_count(geom_bar)`
+ `stat_bin(geom_histogram)`
+ `stat_density(geom_density)`
+ `stat_boxplot(geom_boxplot)`
+ `stat_ydensity(geom_violin)`
]


.rightcol40[
&lt;img src="image/gg_stat.png" width="70%" style="display: block; margin: auto;" /&gt;
]

---
## Statistics

.leftcol[
**Computed aesthetics**

When a stat perform a transformation, new variables are created.

e.g., in `geom_histogram` computed variables are:

  + **`count`** - number of points in bin
  + **`density`**  - density of points in bins, scaled to integrate to 1 ncount.
  + **`ncount`** - count, scaled to maximum of 1
  + **`ndensity`** - density, scaled to maximum of 1
  

To access:
  + old way: **`..&lt;stat name&gt;..`**
  + new way: **`stat(name)`**
  
]

.rightcol[

```r
ggplot(data = mpg, mapping = aes(x = displ)) +
* geom_histogram(aes(y = ..count..))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-60-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---
## Statistics

.leftcol[
**Computed aesthetics**

When a stat perform a transformation, new variables are created.

e.g., in `geom_histogram` computed variables are:

  + **`count`** - number of points in bin
  + **`density`**  - density of points in bins, scaled to integrate to 1 ncount.
  + **`ncount`** - count, scaled to maximum of 1
  + **`ndensity`** - density, scaled to maximum of 1
  

To access:
  + old way: **`..&lt;stat name&gt;..`**
  + new way: **`stat(name)`**
  
]

.rightcol[

```r
ggplot(data = mpg, mapping = aes(x = displ)) +
* geom_histogram(aes(y = stat(density)))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-61-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Displaying distribution

.leftcol40[
Ways to look at distributions:

+ Histograms

+ Frequency polygons

+ Density plots

+ Boxplots

+ Violin plots
]

.rightcol60[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-62-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Displaying distribution

.leftcol40[
**Histogram and freq polygon**

**`geom_histogram`**
+ display counts with bars
+ require continuous data

]

.rightcol60[

```r
ggplot(data = data1, mapping = aes(x = price)) + 
* geom_histogram()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-63-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Displaying distribution

.leftcol40[
**Histogram and freq polygon**

**`geom_histogram`**
+ display counts with bars
+ require continuous data


**`geom_freqpoly`**
+ use lines instead of bars
+ same parameters can be applied
  + bindwith
  + bins
]

.rightcol60[

```r
ggplot(data = data1, mapping = aes(x = price)) + 
* geom_freqpoly()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-64-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Displaying distribution

.leftcol40[
**Histogram and freq polygon**

**`geom_histogram`**
+ display counts with bars
+ require continuous data


**`geom_freqpoly`**
+ use lines instead of bars
+ same parameters can be applied
  + bindwith
  + bins
]

.rightcol60[

```r
ggplot(data = data1, mapping = aes(x = price)) + 
* geom_freqpoly() +
* geom_histogram(alpha = 0.4)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-65-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Displaying distribution

.leftcol40[

**`Density plots`**

**`geom_density`**
+ a smoothed version of the frequency polygon
+ different from **`geom_area`** where aesthetic y is needed

]

.rightcol60[

```r
ggplot(data = data1, mapping = aes(x = depth)) +
* geom_density()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-66-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Displaying distribution

.leftcol40[

**`Density plots`**

**`geom_density`**
+ a smoothed version of the frequency polygon
+ different from **`geom_area`** where aesthetic y is needed

]

.rightcol60[

```r
ggplot(data = data1, mapping = aes(x = depth, color = cut, fill = cut)) +
* geom_density(alpha = 0.4)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-67-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Displaying distribution

.leftcol40[

**`Density plots`**

**`geom_density`**
+ a smoothed version of the frequency polygon
+ different from **`geom_area`** where aesthetic y is needed

**`geom_density_ridges`**
+ available in **ggridges** package
+ create a ridgeline plots

]

.rightcol60[


```r
install.packages("ggridges")
library(ggridges)
ggplot(data = data1, mapping = aes(x = depth, color = cut, fill = cut)) +
* geom_density_ridges(aes(y = cut))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-69-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Displaying distribution

.leftcol40[
**Practice exercise**

Use the `mpg` data to recreate the plot shown on the right.
]

.rightcol60[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-70-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Displaying distribution

.leftcol40[
**Boxplot**

**`geom_boxplot`**
+ Interesting parameters
  + width and varwidth
  + show.legend
  + outlier.alpha
  + outlier.shape
]

.rightcol60[

```r
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) +
* geom_boxplot()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-71-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Displaying distribution

.leftcol40[
**Violin plot**

**`geom_violin`**
+ Interesting parameters
  + trim
  + scale
  + draw_quantiles
]

.rightcol60[

```r
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) +
* geom_violin()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-72-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Displaying distribution

.leftcol40[
**Practice exercise**

Use the `mpg` data to recreate the plot shown on the right.
]

.rightcol60[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-73-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

class: middle center

# Scales and position adjustments

----

---

## Scales and position adjustments

.leftcol60[
+ syntax

```r
ggplot(data = &lt;dataset&gt;,
       mapping = aes(x = &lt;varX&gt;, y = &lt;varY&gt;, ...)) +
  geom_&lt;function&gt;(..., stat = &lt;stat&gt;, position = &lt;position&gt;) +0
  geom_&lt;stat&gt;(...) + 
* scale_&lt;aesthetic&gt;_&lt;type&gt;
```

+ **Scales** control how data values are translated to visual properties

+ Can overide default scales like axis,legend, and transformation of data to aesthetics.

]

.rightcol40[
&lt;img src="image/gg_scale.png" width="70%" style="display: block; margin: auto;" /&gt;
]




---

## Scales

.leftcol40[

Scales belong to one these types:

+ continuous scale
+ discrete scale
+ binned scale

Naming scheme:

+ *scale + aesthetic + name of scale*

  + `scale_*_continuous()`
  + `scale_*_discrete()`
  + `scale_*_manual()`
]

--

.rightcol60[
&lt;img src="image/scale_collection.jpg" width="100%" style="display: block; margin: auto;" /&gt;
]
---

## Scales

.leftcol40[

]

.rightcol60[
&lt;img src="image/scale_params.jpg" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Scales

.leftcol[




```r
p &lt;- ggplot(iris_data, aes(x = sepal_length, y = sepal_width, color = species)) + geom_point(size = 2)
p
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-79-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.rightcol[

```r
p + scale_color_manual(name = "Manual",
                       values = c("#5BC0EB","#FDE74C","#9BC53D"))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-80-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Scale

.leftcol60[

**Position scales**

#### Continuous
+ scale_x_continuous | scale_y_continuous
+ scale_x_log10 | scale_y_log10
+ scale_x_reverse | scale_y_reverse
+ scale_x_sqrt | scale_x_sqrt

]

.rightcol40[

```
scale_x_continuous(
  name = waiver(),
  breaks = waiver(),
  minor_breaks = waiver(),
  n.breaks = NULL,
  labels = waiver(),
  limits = NULL,
  expand = waiver()
  oob = censor,
  na.value = NA_real_,
  trans = "identity",
  position = "bottom",
  guide = waiver,
  )
```
]

---

## Scale

.leftcol60[

**Position scales**

#### Continuous
+ scale_x_continuous | scale_y_continuous
+ scale_x_log10 | scale_y_log10
+ scale_x_reverse | scale_y_reverse
+ scale_x_sqrt | scale_x_sqrt

#### Binned
+ scale_x_binned | scale_y_binned

]

.rightcol40[
```
scale_x_binned(
  name = waiver(),
  breaks = waiver(),
  labels = waiver(),
  limits = NULL,
  exapand = waiver()
  oob = censor,
  na.value = NA_real_,
  trans = "identity",
  position = "bottom",
  )
```
]

---

## Scale

.leftcol60[

**Position scales**

#### Continuous
+ scale_x_continuous | scale_y_continuous
+ scale_x_log10 | scale_y_log10
+ scale_x_reverse | scale_y_reverse
+ scale_x_sqrt | scale_x_sqrt

#### Binned
+ scale_x_binned | scale_y_binned

#### Discrete
+ scale_x_discrete | scale_y_discrete

]

.rightcol40[
```
scale_x_binned(
  name = waiver(),
  breaks = waiver(),
  labels = waiver(),
  limits = NULL,
  exapand = waiver()
  oob = censor,
  na.value = NA_real_,
  trans = "identity",
  position = "bottom",
  )
```
]

---

## Scale

.leftcol[

**Color scales**

Continuous
+ scale_color_continuous | scale_fill_continuous
+ scale_color_gradient | scale_fill_gradient

Binned
+ scale_color_binned | scale_fill_binned
+ scale_color_steps | scale_fill_steps

Discrete
+ scale_color_discrete | scale_fill_discrete
+ scale_color_hue | scale_fill_hue
+ scale_color_grey | scale_color_grey

]


---

## Scale

.leftcol[

**Viridis family**

Continuous
+ scale_color_viridis_c 
+ scale_fill_viridis_c

Binned
+ scale_color_viridis_b 
+ scale_fill_viridis_b

Discrete
+ scale_color_viridis_d 
+ scale_fill_viridis_d

]

--

.rightcol[

```r
ggplot(mtcars, aes(mpg, wt, color = cyl)) +
  geom_point(size = 3) +
  scale_color_viridis_c()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-81-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Scale

.leftcol[

**Colorbrewer family**

Continuous
+ scale_color_distiller | scale_fill_distiller

Binned
+ scale_color_fermenter | scale_fill_fermenter

Discrete
+ scale_color_brewer | scale_fill_brewer


```
#Useful parameters
type = "seq"(sequential, the default), "div"(diverging), "qual"(qualitative)
direction = 1 (default), -1 (reverse order)
palette = name of pallete or index
```


]

--

.rightcol[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-82-1.png" width="80%" style="display: block; margin: auto;" /&gt;&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-82-2.png" width="80%" style="display: block; margin: auto;" /&gt;&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-82-3.png" width="80%" style="display: block; margin: auto;" /&gt;
]


---

## Scales

**`scale_*_manual`**

.leftcol[

+ available only for discrete scales
+ useful if you want to specify your own set of mappings from levels in the data to aesthetic values.

For example

+ choosing set of colors in discrete color scale
+ specifying your own set of alpha
+ specifying your own set of shapes
+ specifying your own set of linetypes
+ ...

]

--

.rightcol[


```r
ggplot(mtcars, aes(x = mpg, y = wt, color = factor(cyl))) +
  geom_point(size = 4) +
* scale_color_manual(values = c("blue", "black", "orange"))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-83-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Scales

**`scale_*_manual`**

.leftcol[

+ available only for discrete scales
+ useful if you want to specify your own set of mappings from levels in the data to aesthetic values.

For example

+ choosing set of colors in discrete color scale
+ specifying your own set of alpha
+ specifying your own set of shapes
+ specifying your own set of linetypes
+ ...
]

--

.rightcol[

```r
ggplot(mtcars, aes(x = mpg, y = wt, alpha = factor(cyl))) +
  geom_point(size = 4) +
* scale_alpha_manual(values = c(0.3, 0.6, 1))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-84-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Scales

**`scale_*_manual`**

.leftcol[

+ available only for discrete scales
+ useful if you want to specify your own set of mappings from levels in the data to aesthetic values.

For example

+ choosing set of colors in discrete color scale
+ specifying your own set of alpha
+ specifying your own set of shapes
+ specifying your own set of linetypes
+ ...

]

--

.rightcol[


```r
ggplot(mtcars, aes(x = mpg, y = wt, shape = factor(cyl))) +
  geom_point(size = 4) +
* scale_shape_manual(values = c(5, 10, 8))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-85-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Scales

.leftcol[
**Shortcuts**

#### Labs

+ modify axis, legend, and plot labels
+ `xlabs`, `ylabs`: modify `x` and `y` axis label names
+ use `labs` with arguments:
  + title
  + x
  + subtitle
  + caption
]

--

.rightcol[

```r
ggplot(mtcars, aes(mpg, wt)) + geom_point(size = 3) + 
* labs(title = "Title of my plot",
*      x = "Miles per gallon",
*      y = "Weight",
*      subtitle = "This would be a subtitle",
*      caption = "This is my caption")
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-86-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Scales

.leftcol[
**Shortcuts**

#### Lims

+ modify limits of the plot
+ use `xlim` and `ylim`
```
xlim(0,50)
ylim(NA, 40)
```
+ or `lims` specifying vectors
```
lims(x = c(0, 50))
lims(y = y(NA, 40))
```
]

--

.rightcol[

```r
ggplot(mtcars, aes(mpg, wt)) + geom_point(size = 3) + 
  labs(title = "Title of my plot",
       x = "Miles per gallon",
       y = "Weight",
       subtitle = "This would be a subtitle",
       caption = "This is my caption") +
* xlim(10, 25)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-87-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Scales

.leftcol[
**Shortcuts**

#### Lims

+ modify limits of the plot
+ use `xlim` and `ylim`
```
xlim(0,50)
ylim(NA, 40)
```
+ or `lims` specifying vectors
```
lims(x = c(0, 50))
lims(y = y(NA, 40))
```
]

--

.rightcol[

```r
ggplot(mtcars, aes(mpg, wt)) + geom_point(size = 3) + 
  labs(title = "Title of my plot",
       x = "Miles per gallon",
       y = "Weight", 
       subtitle = "This would be a subtitle",
       caption = "This is my caption") + 
* lims(x = c(0, 20),
*      y = c(1, 4))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-88-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Position adjustments

.leftcol[

+ All layers have a position that resolves overlapping `geoms`

+ Overrides default using `position` argument to `geom_` or `stat_` function.

]


---

## Position adjustments

.leftcol[

**`position_identity`**

+ `?position_identity`

+ Adds random noise to the data points to avoid overlaps

+ Useful for scatterplots

**Ways to call**

```
position = "identity"
position = position_identity()
```
]

--

.rightcol[

```r
ggplot(mpg, aes(x = class, y = hwy)) + 
  geom_point(size = 3,
*            position = "identity")
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-89-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Position adjustments

.leftcol[

**`position_jitter`**

+ `?position_jitter`

+ Adds random noise to the data points to avoid overlaps

+ Useful for scatterplots
  + wrapper: `geom_jitter`

**Parameters**

```
seeds = random seeds to make jitter reproducible
width = amount of jitter horizontally
height = amount of jitter vertically
```
]

--

.rightcol[

```r
ggplot(mpg, aes(x = class, y = hwy)) + 
  geom_point(size = 3,
*            position = position_jitter(width = 0.2,
*                                       seed = 143 ))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-90-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Position adjustments

.leftcol[

**`position_stack()`**

+ `?position_stack`
+ Stacks geoms on top of each other.

**`position_fill()`**

+ `?position_fill`
+ Stacks `geoms` on top of each other and standardizes the height.

**Parameters**

```
reverse - default = FALSE, if TRUE will reverse the default stacking order.
```

]

--

.rightcol[

```r
ggplot(mtcars, aes(x = factor(cyl), fill = factor(vs))) + 
  geom_bar(alpha = 0.5,
           position = "identity")
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-91-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Position adjustments

.leftcol[

**`position_stack()`**

+ `?position_stack`
+ Stacks geoms on top of each other.

**`position_fill()`**

+ `?position_fill`
+ Stacks `geoms` on top of each other and standardizes the height.

**Parameters**

```
reverse - default = FALSE, if TRUE will reverse the default stacking order.
```

]

--

.rightcol[

```r
ggplot(mtcars, aes(x = factor(cyl), fill = factor(vs))) + 
  geom_bar(alpha = 0.5,
*          position = "stack")
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-92-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Position adjustments

.leftcol[

**`position_stack()`**

+ `?position_stack`
+ Stacks geoms on top of each other.

**`position_fill()`**

+ `?position_fill`
+ Stacks `geoms` on top of each other and standardizes the height.

**Parameters**

```
reverse - default = FALSE, if TRUE will reverse the default stacking order.
```

]

--

.rightcol[

```r
ggplot(mtcars, aes(x = factor(cyl), fill = factor(vs))) + 
  geom_bar(alpha = 0.5,
*          position = "fill")
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-93-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---


## Position adjustment

.leftcol[

**`position_dodge`**

+ `?position_dodge`

+ preserves the vertical position of a geom while adjusting the horizontal position.

]

.rightcol[

```r
ggplot(mtcars, aes(x = factor(cyl), fill = factor(vs))) + 
  geom_bar(alpha = 0.5,
*          position = "dodge")
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-94-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---


## Position adjustment

.leftcol[

**`position_dodge`**

+ `?position_dodge`

+ preserves the vertical position of a geom while adjusting the horizontal position.


**Parameters**

```
width(default = 0.9) refers to dodging width
preserve = "single" / "total" (defaul = "total")
```

]

.rightcol[

```r
ggplot(mtcars, aes(x = factor(cyl), fill = factor(vs))) + 
  geom_bar(alpha = 0.5,
*          position = position_dodge(width = 1))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-95-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---


## Position adjustment

.leftcol[

**`position_dodge`**

+ `?position_dodge`

+ preserves the vertical position of a geom while adjusting the horizontal position.


**Parameters**

```
width(default = 0.9) refers to dodging width
preserve = "single" / "total" (defaul = "total")
```

]

.rightcol[

```r
ggplot(mtcars, aes(x = factor(cyl), fill = factor(vs))) + 
  geom_bar(alpha = 0.5,
           position = position_dodge(width = 1,
*                                    preserve = "single"))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-96-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Scales and position adjustments

.leftcol40[
**Practice exercise**

Use the code below to generate a hypothetical dataset and recreate the barplot on the right.


```r
# Create some data
df &lt;- data.frame(supp=rep(c("VC", "OJ"), each=3),
                dose=rep(c("0.5", "1", "2"),2),
                len=c(6.8, 15, 33, 4.2, 10, 29.5))
```

]

.rightcol[
&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-98-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]


---
## Coordinates

.leftcol[

syntax


```r
ggplot(data = &lt;dataset&gt;,
       mapping = aes(x = &lt;varX&gt;, y = &lt;varY&gt;, ...)) +
  geom_&lt;function&gt;(..., stat = &lt;stat&gt;, position = &lt;position&gt;) +
  geom_&lt;stat&gt;(...) +
  &lt;scale function&gt; +
  &lt;coordinate function&gt;
```

+ Coordinate are sets that locate points in space

+ `coord_cartesian()`

+ `coord_flip()`

+ `coord_polar()`

]

.rightcol[
&lt;img src="image/gg_coord.png" width="70%" style="display: block; margin: auto;" /&gt;

]

---

## Coordinates

.leftcol[

**`coord_cartesian()`**

+ default coordinate system

**Zooming into plots**

+ setting limits using scale
  + eliminates data outside the specified range
  
+ setting limits using coordinate system
  + proper way to zoom
  + does not eliminate data outside the plot

**Parameters**

```
xlim, ylim, expand, clip
```

]

.rightcol[

```r
p &lt;- ggplot(mtcars, aes(x = mpg, y = hp)) + geom_point(size = 3) + geom_smooth(size = 1.5)
print(p)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-101-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Coordinates

.leftcol[

**`coord_cartesian()`**

+ default coordinate system

**Zooming into plots**

+ setting limits using scale
  + eliminates data outside the specified range
  
+ setting limits using coordinate system
  + proper way to zoom
  + does not eliminate data outside the plot

**Parameters**

```
xlim, ylim, expand, clip
```

]

.rightcol[

```r
p + 
* scale_x_continuous(limits = c(15, 20))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-102-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Coordinates

.leftcol[

**`coord_cartesian()`**

+ default coordinate system

**Zooming into plots**

+ setting limits using scale
  + eliminates data outside the specified range
  
+ setting limits using coordinate system
  + proper way to zoom
  + does not eliminate data outside the plot

**Parameters**

```
xlim, ylim, expand, clip
```

]

.rightcol[

```r
p + 
* coord_cartesian(xlim = c(15, 20))
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-103-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Coordinates

.leftcol[

**`coord_cartesian()`**

+ default coordinate system

**Zooming into plots**

+ setting limits using scale
  + eliminates data outside the specified range
  
+ setting limits using coordinate system
  + proper way to zoom
  + does not eliminate data outside the plot

**Parameters**

```
xlim, ylim, expand, clip
```

]

.rightcol[

```r
p + 
* coord_cartesian(expand = FALSE)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-104-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Coordinates

.leftcol[

**`coord_cartesian()`**

+ default coordinate system

**Zooming into plots**

+ setting limits using scale
  + eliminates data outside the specified range
  
+ setting limits using coordinate system
  + proper way to zoom
  + does not eliminate data outside the plot

**Parameters**

```
xlim, ylim, expand, clip
```

]

.rightcol[

```r
p + 
  coord_cartesian(expand = FALSE,
*                 clip = "off")
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-105-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Coordinates

.leftcol[

**`coord_flip()`**

+ Flips cartesian coordinates (i.e., horizontal axis becomes vertical axis).

+ Useful to draw plots in horizontal mode without having to change the aesthetic mappings.


]

.rightcol[

```r
p + 
* coord_flip()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-106-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Coordinates

.leftcol[

**`coord_polar()`**

+ Apply a pola coordinate system to the plot

**Parameters**

```
theta : map angle to x or y
direction: 1 (clockwise) -1 (anticlockwise)
start: offset of starting point in radian
```



]

.rightcol[

```r
ggplot(mpg, aes(x = displ)) + 
  geom_bar()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-107-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Coordinates

.leftcol[

**`coord_polar()`**

+ Apply a pola coordinate system to the plot

**Parameters**

```
theta : map angle to x or y
direction: 1 (clockwise) -1 (anticlockwise)
start: offset of starting point in radian
```



]

.rightcol[

```r
ggplot(mpg, aes(x = displ)) + geom_bar() +
* coord_polar()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-108-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Coordinates

.leftcol[

**`coord_polar()`**

+ Apply a pola coordinate system to the plot

**Parameters**

```
theta : map angle to x or y
direction: 1 (clockwise) -1 (anticlockwise)
start: offset of starting point in radian
```



]

.rightcol[

```r
ggplot(mpg, aes(x = displ)) + geom_bar() +
* coord_polar(theta = "y")
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-109-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Coordinates

.leftcol[

**`coord_polar()`**

+ Apply a pola coordinate system to the plot

**Parameters**

```
theta : map angle to x or y
direction: 1 (clockwise) -1 (anticlockwise)
start: offset of starting point in radian
```



]

.rightcol[

```r
ggplot(mpg, aes(x = displ)) + geom_bar() +
  coord_polar(theta = "y",
*             direction = -1)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-110-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Coordinates

.leftcol[

**`coord_polar()`**

+ Apply a pola coordinate system to the plot

**Parameters**

```
theta : map angle to x or y
direction: 1 (clockwise) -1 (anticlockwise)
start: offset of starting point in radian
```



]

.rightcol[

```r
ggplot(mpg, aes(x = displ)) + geom_bar() +
  coord_polar(theta = "y",
*             start = 0.5)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-111-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

class: middle center

# Facets and Themes
----


---

## Facets

.leftcol[

syntax


```r
ggplot(data = &lt;dataset&gt;,
       mapping = aes(x = &lt;varX&gt;, y = &lt;varY&gt;, ...)) +
  geom_&lt;function&gt;(..., stat = &lt;stat&gt;, position = &lt;position&gt;) +
  geom_&lt;stat&gt;(...) +
  &lt;scale function&gt; +
  &lt;coordinate function&gt; +
  facet_&lt;function&gt;
```

+ Facets divide plot into subplots based on the values of one or more discrete variables.

+ `facet_wrap()`

+ `facet_grid()`

]

.rightcol[
&lt;img src="image/gg_facet.png" width="70%" style="display: block; margin: auto;" /&gt;

]


---

## Facets

.leftcol[
**`facet_wrap**

+ "wraps" a 1d ribbon of panels into 2d
+ useful if you have a variable with many levels

**Parameters**

```
ncol
nrow
scales

```

]

.rightcol[



```r
ggplot(mpg, aes(x = displ, hwy)) + 
  geom_blank() + 
  xlab(NULL)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-115-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Facets

.leftcol[
**`facet_wrap**

+ "wraps" a 1d ribbon of panels into 2d
+ useful if you have a variable with many levels

```
ncol
nrow
scales

```

]

.rightcol[

```r
ggplot(mpg, aes(x = displ, hwy)) + 
  geom_blank() + 
  xlab(NULL) +
* facet_wrap(~ class)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-116-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Facets

.leftcol[
**`facet_grid**

+ produces a 2d grid of panels defined by variables which form the rows and columns

+ `.~ a` spreads the values across columns

+ `b ~ .` spreads the values of `b` down the ro
ws
+ `a ~ b` spreads `a` across columns and `b` down rows


]

.rightcol[

```r
ggplot(mpg, aes(x = displ, hwy)) + 
  geom_blank() + 
  xlab(NULL) +
* facet_grid(. ~ cyl)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-117-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Facets

.leftcol[
**`facet_grid**

+ produces a 2d grid of panels defined by variables which form the rows and columns
+ `.~ a` spreads the values across columns

+ `b ~ .` spreads the values of `b` down the rows

+ `a ~ b` spreads `a` across columns and `b` down rows


]

.rightcol[

```r
ggplot(mpg, aes(x = displ, hwy)) + 
  geom_blank() + 
  xlab(NULL) +
* facet_grid(drv ~ .)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-118-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Facets

.leftcol[
**`facet_grid**

+ produces a 2d grid of panels defined by variables which form the rows and columns
+ `.~ a` spreads the values across columns

+ `b ~ .` spreads the values of `b` down the rows

+ `a ~ b` spreads `a` across columns and `b` down rows


]

.rightcol[

```r
ggplot(mpg, aes(x = displ, hwy)) + 
  geom_blank() + 
  xlab(NULL) +
* facet_grid(drv ~ cyl)
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-119-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Themes


.leftcol[

syntax


```r
ggplot(data = &lt;dataset&gt;,
       mapping = aes(x = &lt;varX&gt;, y = &lt;varY&gt;, ...)) +
  geom_&lt;function&gt;(..., stat = &lt;stat&gt;, position = &lt;position&gt;) +
  geom_&lt;stat&gt;(...) +
  &lt;scale function&gt; +
  &lt;coordinate function&gt; +
  facet_&lt;function&gt;
  theme_&lt;function&gt;
```

+ Controlling all non-data elements
 + title appearance
 + axis labels
 + axis ticks
 + strips
 + ....


]

.rightcol[
&lt;img src="image/gg_theme.png" width="70%" style="display: block; margin: auto;" /&gt;

]

---

## Themes

.leftcol[
**Options**

+ Using the built-in-theme from `ggplot2` library
  + `theme_gray()`
  + `theme_bw()`
  + `theme_light()`
  + `theme_classic(`)
  + `...`
  
+ Using other package e.g., `ggthemes` 

]

.rightcol[

```r
ggplot(mpg, aes(x = displ, hwy, color = factor(cyl))) + 
  geom_point(size = 3) +
* theme_gray()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-122-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Themes

.leftcol[
**Options**

+ Using the built-in-theme from `ggplot2` library
  + `theme_gray()`
  + `theme_bw()`
  + `theme_light()`
  + `theme_classic(`)
  + `...`
  
+ Using other package e.g., `ggthemes` 

]

.rightcol[

```r
ggplot(mpg, aes(x = displ, hwy, color = factor(cyl))) + 
  geom_point(size = 3) +
* theme_bw()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-123-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Themes

.leftcol[
**Options**

+ Using the built-in-theme from `ggplot2` library
  + `theme_gray()`
  + `theme_bw()`
  + `theme_light()`
  + `theme_classic(`)
  + `...`
  
+ Using other package e.g., `ggthemes` 

]

.rightcol[

```r
ggplot(mpg, aes(x = displ, hwy, color = factor(cyl))) + 
  geom_point(size = 3, show.legend = FALSE) +
  facet_wrap(~ cyl) +
* theme_bw()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-124-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Themes

.leftcol[
**Options**

+ Using the built-in-theme from `ggplot2` library
  + `theme_gray()`
  + `theme_bw()`
  + `theme_light()`
  + `theme_classic(`)
  + `...`
  
+ Using other package e.g., `ggthemes` 

]

.rightcol[

```r
ggplot(mpg, aes(x = displ, hwy, color = factor(cyl))) + 
  geom_point(size = 3) +
* theme_classic()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-125-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Themes

.leftcol[
**Options**

+ Using the built-in-theme from `ggplot2` library
  
+ Using other package e.g., `ggthemes` 
  + `theme_economist_white()`
  + `theme_fivethirtyeight()`
  + `theme_stata()`
  + `theme_tufte()`
  

]

.rightcol[

```r
library(ggthemes)
ggplot(mpg, aes(x = displ, hwy, color = factor(cyl))) + 
  geom_point(size = 3) +
* theme_economist_white()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-126-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Themes

.leftcol[
**Options**

+ Using the built-in-theme from `ggplot2` library
  
+ Using other package e.g., `ggthemes` 
  + `theme_economist_white()`
  + `theme_fivethirtyeight()`
  + `theme_stata()`
  + `theme_tufte()`
  

]

.rightcol[

```r
ggplot(mpg, aes(x = displ, hwy, color = factor(cyl))) + 
  geom_point(size = 3) +
* theme_fivethirtyeight()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-127-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Themes

.leftcol[
**Options**

+ Using the built-in-theme from `ggplot2` library
  
+ Using other package e.g., `ggthemes` 
  + `theme_economist_white()`
  + `theme_fivethirtyeight()`
  + `theme_stata()`
  + `theme_tufte()`
  

]

.rightcol[

```r
library(ggthemes)
ggplot(mpg, aes(x = displ, hwy, color = factor(cyl))) + 
  geom_point(size = 3) +
* theme_stata()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-128-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Themes

.leftcol[
**Options**

+ Using the built-in-theme from `ggplot2` library
  
+ Using other package e.g., `ggthemes` 
  + `theme_economist_white()`
  + `theme_fivethirtyeight()`
  + `theme_stata()`
  + `theme_tufte()`
  

]

.rightcol[

```r
library(ggthemes)
ggplot(mpg, aes(x = displ, hwy, color = factor(cyl))) + 
  geom_point(size = 3) +
* theme_tufte()
```

&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-129-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Practice exercise

.leftcol40[
**Let's apply what we have covered!**

+ Use the mpg dataset to recreate the plot.

+ But first, we need to do some data wrangling!

+ Use the updated mpg data to mimic the plot.


]

.rightcol60[


&lt;img src="02_understanding_ggplot2_files/figure-html/unnamed-chunk-131-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

class: center

## Session 2... DONE!


&lt;img src="image/proud_of_you.gif" width="60%" style="display: block; margin: auto;" /&gt;



---

class: middle center

# Thank you!

#### Slides created via the R packages:

.leftcol[
&lt;img src="image/xaringan.png" style="display:inline-block; margin: 0" width=20%/&gt; 

### xaringan by Yihui
]

.rightcol[
&lt;img src="image/xaringanthemer.png" style="display:inline-block; margin: 0" width=25%/&gt; 

### xaringanthemer and xaringanExtra by Garrick
]
















    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<script>
  (function() {
    var divHTML = document.querySelectorAll(".details-open");
    divHTML.forEach(function (el) {
      var preNodes = el.getElementsByTagName("pre");
      var outputNode = preNodes[1];
      outputNode.outerHTML = "<details open class='output'><summary>Run</summary>" + outputNode.outerHTML + "</details>";
    })
  })();
(function() {
  var divHTML = document.querySelectorAll(".details");
  divHTML.forEach(function (el) {
    var preNodes = el.getElementsByTagName("pre");
    var outputNode = preNodes[1];
    outputNode.outerHTML = "<details class='output'><summary>Run</summary>" + outputNode.outerHTML + "</details>";
  })
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
